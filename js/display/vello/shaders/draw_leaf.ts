/* eslint-disable */
import util from './shared/util.js';
import transform from './shared/transform.js';
import bbox from './shared/bbox.js';
import drawtag from './shared/drawtag.js';
import clip from './shared/clip.js';
import config from './shared/config.js';

export default `${config}
${clip}
${drawtag}
${bbox}
${transform}
@group(0)@binding(0)var<uniform>_m:_aG;@group(0)@binding(1)var<storage>_n:array<u32>;@group(0)@binding(2)var<storage>_aq:array<_aF>;@group(0)@binding(3)var<storage>_U:array<_cf>;@group(0)@binding(4)var<storage,read_write>_ak:array<_aF>;@group(0)@binding(5)var<storage,read_write>_o:array<u32>;@group(0)@binding(6)var<storage,read_write>_cI:array<_es>;${util}
const _j=256u;fn _eS(_cR:u32,ix:u32)->_az{let _t=_cR+ix*6u;let c0=bitcast<f32>(_n[_t]);let c1=bitcast<f32>(_n[_t+1u]);let c2=bitcast<f32>(_n[_t+2u]);let c3=bitcast<f32>(_n[_t+3u]);let c4=bitcast<f32>(_n[_t+4u]);let c5=bitcast<f32>(_n[_t+5u]);let _i=vec4(c0,c1,c2,c3);let _bc=vec2(c4,c5);return _az(_i,_bc);}var<workgroup>_at:array<_aF,_j>;@compute @workgroup_size(256)fn main(@builtin(global_invocation_id)_G:vec3<u32>,@builtin(local_invocation_id)_f:vec3<u32>,@builtin(workgroup_id)_aj:vec3<u32>,){let ix=_G.x;var agg=_il();if _f.x<_aj.x{agg=_aq[_f.x];}_at[_f.x]=agg;for(var i=0u;i<firstTrailingBit(_j);i+=1u){workgroupBarrier();if _f.x+(1u<<i)<_j{let _Z=_at[_f.x+(1u<<i)];agg=_eq(agg,_Z);}workgroupBarrier();_at[_f.x]=agg;}workgroupBarrier();var m=_at[0];workgroupBarrier();let _D=_gs(ix);agg=_gN(_D);_at[_f.x]=agg;for(var i=0u;i<firstTrailingBit(_j);i+=1u){workgroupBarrier();if _f.x>=1u<<i{let _Z=_at[_f.x-(1u<<i)];agg=_eq(agg,_Z);}workgroupBarrier();_at[_f.x]=agg;}workgroupBarrier();if _f.x>0u{m=_eq(m,_at[_f.x- 1u]);}if ix<_m._cz{_ak[ix]=m;}let dd=_m._fn+m._by;let di=m._N;if _D==_fl||_D==_ep||_D==_eo||_D==_en||_D==_dD{let _b=_U[m._P];let _jf=u32(_b._L>=0.);var _x=_az();var _L=_b._L;if _L>=0.||_D==_ep||_D==_eo||_D==_en{_x=_eS(_m._cR,_b._bz);}if _L>=0.{let _i=_x._i;_L*=sqrt(abs(_i.x*_i.w-_i.y*_i.z));}switch _D{case 0x42u:{_o[di]=bitcast<u32>(_L);}case 0x10au:{_o[di]=bitcast<u32>(_L);var p0=bitcast<vec2<f32>>(vec2(_n[dd+1u],_n[dd+2u]));var p1=bitcast<vec2<f32>>(vec2(_n[dd+3u],_n[dd+4u]));p0=_cM(_x,p0);p1=_cM(_x,p1);let _eR=p1-p0;let _J=1./dot(_eR,_eR);let _eQ=_eR*_J;let _dy=-dot(p0,_eQ);_o[di+1u]=bitcast<u32>(_eQ.x);_o[di+2u]=bitcast<u32>(_eQ.y);_o[di+3u]=bitcast<u32>(_dy);}case 0x28eu:{let _eP=1./f32(1<<12u);_o[di]=bitcast<u32>(_L);var p0=bitcast<vec2<f32>>(vec2(_n[dd+1u],_n[dd+2u]));var p1=bitcast<vec2<f32>>(vec2(_n[dd+3u],_n[dd+4u]));var r0=bitcast<f32>(_n[dd+5u]);var r1=bitcast<f32>(_n[dd+6u]);let _fS=_fe(_x);var _bY=_az();var _aW=0.;var _aM=0.;var _aR=0u;var _ae=0u;if abs(r0-r1)<=_eP{_aR=_gT;let _cE=r0/distance(p0,p1);_bY=_dw(_fU(p0,p1),_fS);_aM=_cE*_cE;}else{_aR=_iu;if all(p0==p1){_aR=_gU;p0+=_eP;}if r1==0.{_ae|=_gR;let _hG=p0;p0=p1;p1=_hG;let _hF=r0;r0=r1;r1=_hF;}_aW=r0/(r0-r1);let cf=(1.-_aW)*p0+_aW*p1;_aM=r1/(distance(cf,p1));let _eO=_dw(_fU(cf,p1),_fS);var _eN=_eO;if abs(_aM- 1.)<=_eP{_aR=_gS;let _J=.5*abs(1.-_aW);_eN=_dw(_az(vec4(_J,0.,0.,_J),vec2(0.)),_eO);}else{let a=_aM*_aM- 1.;let _fR=abs(1.-_aW)/a;let _hE=_aM*_fR;let _hD=sqrt(abs(a))*_fR;_eN=_dw(_az(vec4(_hE,0.,0.,_hD),vec2(0.)),_eO);}_bY=_eN;}_o[di+1u]=bitcast<u32>(_bY._i.x);_o[di+2u]=bitcast<u32>(_bY._i.y);_o[di+3u]=bitcast<u32>(_bY._i.z);_o[di+4u]=bitcast<u32>(_bY._i.w);_o[di+5u]=bitcast<u32>(_bY._bc.x);_o[di+6u]=bitcast<u32>(_bY._bc.y);_o[di+7u]=bitcast<u32>(_aW);_o[di+8u]=bitcast<u32>(_aM);_o[di+9u]=bitcast<u32>((_ae<<3u)|_aR);}case 0x244u:{_o[di]=bitcast<u32>(_L);let _r=_fe(_x);_o[di+1u]=bitcast<u32>(_r._i.x);_o[di+2u]=bitcast<u32>(_r._i.y);_o[di+3u]=bitcast<u32>(_r._i.z);_o[di+4u]=bitcast<u32>(_r._i.w);_o[di+5u]=bitcast<u32>(_r._bc.x);_o[di+6u]=bitcast<u32>(_r._bc.y);_o[di+7u]=_n[dd];_o[di+8u]=_n[dd+1u];}default:{}}}if _D==_dD||_D==_em{var _P=~ix;if _D==_dD{_P=m._P;}_cI[m._ce]=_es(ix,i32(_P));}}fn _fU(p0:vec2<f32>,p1:vec2<f32>)->_az{let _hC=_fT(p0,p1);let _r=_fe(_hC);let _hB=_fT(vec2(0.),vec2(1.,0.));return _dw(_hB,_r);}fn _fT(p0:vec2<f32>,p1:vec2<f32>)->_az{return _az(vec4(p1.y-p0.y,p0.x-p1.x,p1.x-p0.x,p1.y-p0.y),vec2(p0.x,p0.y));}`
