/* eslint-disable */
import drawtag from './shared/drawtag.js';
import clip from './shared/clip.js';
import bbox from './shared/bbox.js';
import config from './shared/config.js';

export default `${config}
${bbox}
${clip}
${drawtag}
@group(0)@binding(0)var<uniform>_m:_aG;@group(0)@binding(1)var<storage>_cI:array<_es>;@group(0)@binding(2)var<storage>_bD:array<_cf>;@group(0)@binding(3)var<storage>_aq:array<_aS>;@group(0)@binding(4)var<storage>_hX:array<_fo>;@group(0)@binding(5)var<storage,read_write>_bS:array<_aF>;@group(0)@binding(6)var<storage,read_write>_hW:array<vec4<f32>>;const _j=256u;var<workgroup>_aE:array<_aS,510>;var<workgroup>_ca:array<u32,_j>;var<workgroup>_dt:array<vec4<f32>,_j>;var<workgroup>_ec:array<vec4<f32>,_j>;var<workgroup>_eb:array<i32,_j>;fn _hZ(_s:ptr<function,_aS>,_hV:u32)->i32{var ix=_hV;var j=0u;while j<firstTrailingBit(_j){let _t=2u*_j-(2u<<(firstTrailingBit(_j)-j));if((ix>>j)&1u)!=0u{let _du=_dG(_aE[_t+(ix>>j)- 1u],*_s);if _du.b>0u{break;}*_s=_du;ix-=1u<<j;}j+=1u;}if ix>0u{while j>0u{j-=1u;let _t=2u*_j-(2u<<(firstTrailingBit(_j)-j));let _du=_dG(_aE[_t+(ix>>j)- 1u],*_s);if _du.b==0u{*_s=_du;ix-=1u<<j;}}}if ix>0u{return i32(ix)- 1;}else{return i32(~0u-(*_s).a);}}fn _hY(ix:u32)->i32{if ix<_m._cT{return _cI[ix]._P;}else{return-2147483648;}}@compute @workgroup_size(256)fn main(@builtin(global_invocation_id)_G:vec3<u32>,@builtin(local_invocation_id)_f:vec3<u32>,@builtin(workgroup_id)_aj:vec3<u32>,){var _s:_aS;if _f.x<_aj.x{_s=_aq[_f.x];}_aE[_f.x]=_s;for(var i=0u;i<firstTrailingBit(_j);i+=1u){workgroupBarrier();if _f.x+(1u<<i)<_j{let _Z=_aE[_f.x+(1u<<i)];_s=_dG(_s,_Z);}workgroupBarrier();_aE[_f.x]=_s;}workgroupBarrier();let _eY=_aE[0].b;let sp=_j- 1u-_f.x;var ix=0u;for(var i=0u;i<firstTrailingBit(_j);i+=1u){let _bu=ix+((_j/2u)>>i);if sp<_aE[_bu].b{ix=_bu;}}let b=_aE[ix].b;var _b=vec4(-1e9,-1e9,1e9,1e9);if sp<b{let el=_hX[ix*_j+b-sp- 1u];_ca[_f.x]=el._dF;_b=el._b;}for(var i=0u;i<firstTrailingBit(_j);i+=1u){_dt[_f.x]=_b;workgroupBarrier();if _f.x>=(1u<<i){_b=_dJ(_dt[_f.x-(1u<<i)],_b);}workgroupBarrier();}_dt[_f.x]=_b;let _aJ=_hY(_G.x);let _cb=_aJ>=0;_s=_aS(1u-u32(_cb),u32(_cb));_aE[_f.x]=_s;if _cb{let _U=_bD[_aJ];_b=vec4(f32(_U.x0),f32(_U.y0),f32(_U.x1),f32(_U.y1));}else{_b=vec4(-1e9,-1e9,1e9,1e9);}var _ge=0u;for(var i=0u;i<firstTrailingBit(_j)- 1u;i+=1u){let _gh=2u*_j-(1u<<(firstTrailingBit(_j)-i));workgroupBarrier();if _f.x<1u<<(firstTrailingBit(_j)- 1u-i){let _gg=_ge+_f.x*2u;_aE[_gh+_f.x]=_dG(_aE[_gg],_aE[_gg+1u]);}_ge=_gh;}workgroupBarrier();_s=_aS();var _Y=_hZ(&_s,_f.x);_eb[_f.x]=_Y;workgroupBarrier();let _ed=select(_Y- 1,_eb[_Y],_Y>=0);var _Q:i32;if _Y>=0{_Q=i32(_aj.x*_j)+_Y;}else if _Y+i32(_eY)>=0{_Q=i32(_ca[i32(_j)+_Y]);}else{_Q=-1;}for(var i=0u;i<firstTrailingBit(_j);i+=1u){if i!=0u{_eb[_f.x]=_Y;}_ec[_f.x]=_b;workgroupBarrier();if _Y>=0{_b=_dJ(_ec[_Y],_b);_Y=_eb[_Y];}workgroupBarrier();}if _Y+i32(_eY)>=0{_b=_dJ(_dt[i32(_j)+_Y],_b);}_ec[_f.x]=_b;workgroupBarrier();if!_cb&&_G.x<_m._cT{let _gf=_cI[_Q];let _P=_gf._P;let _dF=_gf.ix;let ix=~_aJ;_bS[ix]._P=u32(_P);_bS[ix]._by=_bS[_dF]._by;if _ed>=0{_b=_ec[_ed];}else if _ed+i32(_eY)>=0{_b=_dt[i32(_j)+_ed];}else{_b=vec4(-1e9,-1e9,1e9,1e9);}}if _G.x<_m._cT{_hW[_G.x]=_b;}}`
